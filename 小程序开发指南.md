# 📱 小程序开发指南

> 社区食安AI小卫士 - 微信小程序配置与开发

## 🎯 开发环境准备

### 1. 下载微信开发者工具
```
1. 访问: https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
2. 下载适合您系统的版本
3. 安装并启动
```

### 2. 注册微信小程序 (必需)
```
1. 访问微信公众平台: https://mp.weixin.qq.com/
2. 点击「立即注册」→「小程序」
3. 填写注册信息并完成验证
4. 获取小程序AppID
```

## 🔧 项目配置

### 1. 导入项目到微信开发者工具

**步骤1: 打开微信开发者工具**
- 启动微信开发者工具
- 使用微信扫码登录

**步骤2: 导入项目**
```
1. 点击「导入项目」
2. 项目目录: 选择 miniprogram 文件夹
   路径: D:\MyData\projects\mininutriscan\miniprogram
3. AppID: 输入您的小程序AppID
   (如果没有，可以选择「测试号」)
4. 项目名称: 社区食安AI小卫士
5. 点击「导入」
```

### 2. 配置项目设置

**步骤1: 基础设置**
```
1. 在开发者工具中，点击右上角「详情」
2. 在「本地设置」中:
   ✅ 勾选「不校验合法域名、web-view...」
   ✅ 勾选「启用调试模式」
   ✅ 勾选「启用热重载"
```

**步骤2: 网络配置**
```
1. 在「项目配置」中:
   - 确认AppID正确
   - 设置项目名称
2. 在「服务器域名」中添加:
   - request合法域名: https://your-domain.com
   (开发阶段可以在本地设置中跳过校验)
```

## 🚀 启动开发

### 1. 启动后端服务
```
在项目根目录双击运行: 启动服务.bat
或者手动执行: python main.py
```

### 2. 配置API地址
```
1. 打开文件: miniprogram/config/api.js
2. 确认 CURRENT_ENV = 'development'
3. 确认 BASE_URL = 'http://127.0.0.1:8000'
```

### 3. 预览小程序
```
1. 在微信开发者工具中点击「编译」
2. 查看模拟器中的小程序界面
3. 检查控制台是否有错误信息
```

## 🔍 功能测试

### 1. 页面导航测试
```
✅ 首页加载正常
✅ 底部导航栏切换正常
✅ 各个页面能正常打开
```

### 2. API连接测试
```
✅ 网络请求能正常发送
✅ 后端服务响应正常
✅ 数据能正常显示
```

### 3. 核心功能测试
```
✅ 拍照功能正常
✅ 图片上传正常
✅ AI识别功能正常 (需要配置API密钥)
```

## 📱 真机调试

### 1. 预览二维码
```
1. 在微信开发者工具中点击「预览」
2. 生成预览二维码
3. 使用微信扫码在手机上预览
```

### 2. 远程调试
```
1. 点击「真机调试」
2. 生成调试二维码
3. 扫码后可以在开发者工具中调试手机上的小程序
```

## 🚀 发布上线

### 1. 代码上传
```
1. 在微信开发者工具中点击「上传」
2. 填写版本号和项目备注
3. 上传代码到微信服务器
```

### 2. 提交审核
```
1. 登录微信公众平台
2. 进入「版本管理」
3. 将开发版本提交审核
4. 填写审核信息
```

### 3. 发布线上
```
1. 审核通过后，在「版本管理」中发布
2. 用户即可在微信中搜索使用
```

## ❓ 常见问题

### Q1: 导入项目时提示AppID错误
**解决方案:**
- 确认已注册小程序并获取正确的AppID
- 可以先使用测试号进行开发
- 检查AppID格式是否正确

### Q2: 网络请求失败
**解决方案:**
- 确认后端服务已启动 (http://127.0.0.1:8000)
- 在本地设置中勾选「不校验合法域名」
- 检查API配置文件中的地址是否正确

### Q3: 页面显示异常
**解决方案:**
- 检查控制台错误信息
- 确认所有文件路径正确
- 重新编译项目

### Q4: 真机预览时功能异常
**解决方案:**
- 确认手机网络能访问开发服务器
- 使用真机调试模式查看具体错误
- 检查手机微信版本是否支持相关功能

## 📚 开发资源

### 官方文档
- [小程序开发文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [小程序API文档](https://developers.weixin.qq.com/miniprogram/dev/api/)
- [小程序组件文档](https://developers.weixin.qq.com/miniprogram/dev/component/)

### 开发工具
- [微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
- [小程序助手](https://developers.weixin.qq.com/miniprogram/dev/devtools/mydev.html)

---

**开发完成后，您就拥有了一个完整的社区食品安全小程序！** 🎉