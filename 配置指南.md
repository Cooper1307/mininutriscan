# 🔧 环境配置指南

> 社区食安AI小卫士 - 快速配置手册

## 📋 配置清单

### ✅ 已完成的配置
- ✅ Python环境和依赖包
- ✅ PostgreSQL数据库
- ✅ FastAPI后端服务
- ✅ 小程序前端代码

### ⚠️ 需要手动配置的项目

#### 1. 🔑 API密钥配置 (必需)

**步骤1: 获取Qwen AI API密钥**
```
1. 访问阿里云官网: https://www.aliyun.com/
2. 注册/登录阿里云账号
3. 开通通义千问服务
4. 获取API密钥
```

**步骤2: 配置密钥**
```
1. 打开项目根目录的 .env 文件
2. 找到这一行: QWEN_API_KEY=your-qwen-api-key-here
3. 替换为: QWEN_API_KEY=你的实际密钥
4. 保存文件
```

#### 2. 📱 微信小程序配置 (必需)

**步骤1: 注册微信小程序**
```
1. 访问微信公众平台: https://mp.weixin.qq.com/
2. 注册小程序账号
3. 获取AppID和AppSecret
```

**步骤2: 配置小程序信息**
```
1. 在 .env 文件中配置:
   WECHAT_APP_ID=你的小程序AppID
   WECHAT_APP_SECRET=你的小程序AppSecret

2. 在微信开发者工具中:
   - 导入项目: miniprogram 文件夹
   - 设置AppID
   - 配置服务器域名
```

#### 3. 🔧 Redis服务启动 (可选)

**方法1: 使用启动脚本 (推荐)**
```
双击运行: start_redis.bat
```

**方法2: 手动启动**
```
1. 解压 Redis-x64-5.0.14.1.zip
2. 运行 redis-server.exe
```

## 🚀 启动服务

### 1. 启动后端服务
```bash
# 在项目根目录执行
python main.py
```

### 2. 启动Redis (可选)
```bash
# 双击运行
start_redis.bat
```

### 3. 打开小程序
```
1. 打开微信开发者工具
2. 导入项目: miniprogram 文件夹
3. 预览或真机调试
```

## 🔍 验证配置

### 检查后端服务
```
访问: http://127.0.0.1:8000/docs
应该看到API文档页面
```

### 检查数据库连接
```bash
python test_system.py
```

### 检查小程序
```
在微信开发者工具中预览小程序
检查是否能正常加载页面
```

## ❓ 常见问题

### Q1: API密钥配置后仍然报错
**解决方案:**
- 检查密钥是否正确复制
- 确认阿里云账号已开通通义千问服务
- 重启FastAPI服务

### Q2: 微信小程序无法连接后端
**解决方案:**
- 确认后端服务已启动 (http://127.0.0.1:8000)
- 检查小程序中的API地址配置
- 在微信开发者工具中配置合法域名

### Q3: Redis启动失败
**解决方案:**
- 检查端口6379是否被占用
- 以管理员身份运行启动脚本
- Redis服务是可选的，不影响核心功能

## 📞 技术支持

如果遇到配置问题，请:
1. 检查错误日志
2. 参考项目文档
3. 运行系统测试脚本

---

**配置完成后，您就可以开始使用社区食安AI小卫士了！** 🎉