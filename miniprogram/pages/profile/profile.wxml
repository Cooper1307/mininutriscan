<view class="page">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <navigation-bar title="ä¸ªäººä¸­å¿ƒ" show-back="{{false}}">
    <view slot="right" class="nav-right">
      <text class="nav-icon" bindtap="onSettings">âš™ï¸</text>
    </view>
  </navigation-bar>

  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <view class="user-info">
      <view class="avatar-container" bindtap="onAvatarTap">
        <image class="user-avatar" src="{{userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill" />
        <view class="avatar-badge" wx:if="{{userInfo.isVip}}">
          <text class="badge-icon">ğŸ‘‘</text>
        </view>
      </view>
      
      <view class="user-details">
        <view class="user-name" bindtap="onNameEdit">{{userInfo.nickname || 'ç‚¹å‡»è®¾ç½®æ˜µç§°'}}</view>
        <view class="user-level">
          <text class="level-text">{{userInfo.level || 'LV1'}}</text>
          <text class="level-desc">{{userInfo.levelDesc || 'æ–°æ‰‹ç”¨æˆ·'}}</text>
        </view>
        <view class="user-stats">
          <text class="stat-item">æ£€æµ‹æ¬¡æ•°: {{userInfo.detectCount || 0}}</text>
          <text class="stat-divider">|</text>
          <text class="stat-item">ç§¯åˆ†: {{userInfo.points || 0}}</text>
        </view>
      </view>
    </view>
    
    <!-- ä¼šå‘˜çŠ¶æ€ -->
    <view class="vip-status" wx:if="{{!userInfo.isVip}}" bindtap="onVipUpgrade">
      <view class="vip-content">
        <text class="vip-icon">ğŸ’</text>
        <text class="vip-text">å‡çº§ä¼šå‘˜äº«å—æ›´å¤šç‰¹æƒ</text>
      </view>
      <text class="vip-arrow">></text>
    </view>
    
    <view class="vip-status active" wx:else>
      <view class="vip-content">
        <text class="vip-icon">ğŸ‘‘</text>
        <text class="vip-text">ä¼šå‘˜æœ‰æ•ˆæœŸè‡³ {{userInfo.vipExpire}}</text>
      </view>
      <text class="vip-arrow">></text>
    </view>
  </view>

  <!-- æ•°æ®ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="section-header">
      <text class="section-title">æˆ‘çš„æ•°æ®</text>
    </view>
    
    <view class="stats-grid">
      <view class="stat-card" bindtap="onStatTap" data-type="detect">
        <view class="stat-number">{{stats.totalDetections}}</view>
        <view class="stat-label">æ€»æ£€æµ‹æ¬¡æ•°</view>
        <view class="stat-icon">ğŸ”</view>
      </view>
      
      <view class="stat-card" bindtap="onStatTap" data-type="safe">
        <view class="stat-number">{{stats.safeCount}}</view>
        <view class="stat-label">å®‰å…¨é£Ÿå“</view>
        <view class="stat-icon">âœ…</view>
      </view>
      
      <view class="stat-card" bindtap="onStatTap" data-type="warning">
        <view class="stat-number">{{stats.warningCount}}</view>
        <view class="stat-label">é£é™©é£Ÿå“</view>
        <view class="stat-icon">âš ï¸</view>
      </view>
      
      <view class="stat-card" bindtap="onStatTap" data-type="points">
        <view class="stat-number">{{stats.totalPoints}}</view>
        <view class="stat-label">ç´¯è®¡ç§¯åˆ†</view>
        <view class="stat-icon">â­</view>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-section">
    <view class="menu-group">
      <view class="menu-item" bindtap="onMenuTap" data-type="history">
        <view class="menu-left">
          <text class="menu-icon">ğŸ“‹</text>
          <text class="menu-text">æ£€æµ‹å†å²</text>
        </view>
        <view class="menu-right">
          <text class="menu-badge" wx:if="{{stats.todayDetections > 0}}">{{stats.todayDetections}}</text>
          <text class="menu-arrow">></text>
        </view>
      </view>
      
      <view class="menu-item" bindtap="onMenuTap" data-type="favorites">
        <view class="menu-left">
          <text class="menu-icon">â¤ï¸</text>
          <text class="menu-text">æˆ‘çš„æ”¶è—</text>
        </view>
        <view class="menu-right">
          <text class="menu-arrow">></text>
        </view>
      </view>
      
      <view class="menu-item" bindtap="onMenuTap" data-type="reports">
        <view class="menu-left">
          <text class="menu-icon">ğŸ“</text>
          <text class="menu-text">æˆ‘çš„ä¸¾æŠ¥</text>
        </view>
        <view class="menu-right">
          <text class="menu-badge" wx:if="{{stats.pendingReports > 0}}">{{stats.pendingReports}}</text>
          <text class="menu-arrow">></text>
        </view>
      </view>
    </view>
    
    <view class="menu-group">
      <view class="menu-item" bindtap="onMenuTap" data-type="points">
        <view class="menu-left">
          <text class="menu-icon">ğŸ</text>
          <text class="menu-text">ç§¯åˆ†å•†åŸ</text>
        </view>
        <view class="menu-right">
          <text class="menu-hot">HOT</text>
          <text class="menu-arrow">></text>
        </view>
      </view>
      
      <view class="menu-item" bindtap="onMenuTap" data-type="invite">
        <view class="menu-left">
          <text class="menu-icon">ğŸ‘¥</text>
          <text class="menu-text">é‚€è¯·å¥½å‹</text>
        </view>
        <view class="menu-right">
          <text class="menu-desc">èµšç§¯åˆ†</text>
          <text class="menu-arrow">></text>
        </view>
      </view>
      
      <view class="menu-item" bindtap="onMenuTap" data-type="feedback">
        <view class="menu-left">
          <text class="menu-icon">ğŸ’¬</text>
          <text class="menu-text">æ„è§åé¦ˆ</text>
        </view>
        <view class="menu-right">
          <text class="menu-arrow">></text>
        </view>
      </view>
    </view>
    
    <view class="menu-group">
      <view class="menu-item" bindtap="onMenuTap" data-type="help">
        <view class="menu-left">
          <text class="menu-icon">â“</text>
          <text class="menu-text">å¸®åŠ©ä¸­å¿ƒ</text>
        </view>
        <view class="menu-right">
          <text class="menu-arrow">></text>
        </view>
      </view>
      
      <view class="menu-item" bindtap="onMenuTap" data-type="about">
        <view class="menu-left">
          <text class="menu-icon">â„¹ï¸</text>
          <text class="menu-text">å…³äºæˆ‘ä»¬</text>
        </view>
        <view class="menu-right">
          <text class="menu-version">v{{version}}</text>
          <text class="menu-arrow">></text>
        </view>
      </view>
    </view>
  </view>

  <!-- é€€å‡ºç™»å½• -->
  <view class="logout-section" wx:if="{{userInfo.isLogin}}">
    <button class="logout-btn" bindtap="onLogout">é€€å‡ºç™»å½•</button>
  </view>
  
  <!-- ç™»å½•æŒ‰é’® -->
  <view class="login-section" wx:else>
    <button class="login-btn" bindtap="onLogin">ç«‹å³ç™»å½•</button>
    <view class="login-tips">
      <text class="tip-text">ç™»å½•åå¯äº«å—æ›´å¤šä¸ªæ€§åŒ–æœåŠ¡</text>
    </view>
  </view>

  <!-- åº•éƒ¨ä¿¡æ¯ -->
  <view class="footer-info">
    <view class="footer-links">
      <text class="footer-link" bindtap="onFooterTap" data-type="privacy">éšç§æ”¿ç­–</text>
      <text class="footer-divider">|</text>
      <text class="footer-link" bindtap="onFooterTap" data-type="terms">æœåŠ¡æ¡æ¬¾</text>
      <text class="footer-divider">|</text>
      <text class="footer-link" bindtap="onFooterTap" data-type="contact">è”ç³»æˆ‘ä»¬</text>
    </view>
    <view class="footer-copyright">
      <text class="copyright-text">Â© 2024 MiniNutriScan. All rights reserved.</text>
    </view>
  </view>
</view>