<view class="page">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <navigation-bar title="è¥å…»è´´å£«" show-back="{{true}}"></navigation-bar>

  <!-- æœç´¢åŒºåŸŸ -->
  <view class="search-section">
    <view class="search-box">
      <text class="search-icon">ğŸ”</text>
      <input class="search-input" 
             placeholder="æœç´¢è¥å…»çŸ¥è¯†" 
             value="{{searchKeyword}}" 
             bindinput="onSearchInput" 
             bindconfirm="onSearchConfirm" />
      <text class="search-clear" wx:if="{{searchKeyword}}" bindtap="onSearchClear">âœ•</text>
    </view>
  </view>

  <!-- åˆ†ç±»æ ‡ç­¾ -->
  <view class="category-section">
    <scroll-view class="category-scroll" scroll-x>
      <view class="category-list">
        <view class="category-item {{currentCategory === item.id ? 'active' : ''}}" 
              wx:for="{{categories}}" 
              wx:key="id" 
              bindtap="onCategoryTap" 
              data-category="{{item}}">
          <text class="category-name">{{item.name}}</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- è´´å£«åˆ—è¡¨ -->
  <view class="tips-section">
    <view class="tips-list" wx:if="{{filteredTips.length > 0}}">
      <view class="tip-card" 
            wx:for="{{filteredTips}}" 
            wx:key="id" 
            bindtap="onTipTap" 
            data-tip="{{item}}">
        <view class="tip-header">
          <text class="tip-icon">{{item.icon}}</text>
          <view class="tip-meta">
            <text class="tip-title">{{item.title}}</text>
            <text class="tip-category">{{item.categoryName}}</text>
          </view>
          <view class="tip-actions">
            <text class="tip-like {{item.liked ? 'active' : ''}}" 
                  bindtap="onLikeTip" 
                  data-tip="{{item}}" 
                  catchtap="stopPropagation">
              {{item.liked ? 'â¤ï¸' : 'ğŸ¤'}}
            </text>
            <text class="tip-like-count">{{item.likeCount}}</text>
          </view>
        </view>
        
        <view class="tip-content">
          <text class="tip-summary">{{item.summary}}</text>
        </view>
        
        <view class="tip-footer">
          <view class="tip-tags">
            <text class="tip-tag" wx:for="{{item.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</text>
          </view>
          <text class="tip-read-time">{{item.readTime}}åˆ†é’Ÿé˜…è¯»</text>
        </view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:else>
      <text class="empty-icon">ğŸ“š</text>
      <text class="empty-text">{{searchKeyword ? 'æœªæ‰¾åˆ°ç›¸å…³è´´å£«' : 'æš‚æ— è¥å…»è´´å£«'}}</text>
      <text class="empty-tip">{{searchKeyword ? 'è¯•è¯•å…¶ä»–å…³é”®è¯' : 'æ•¬è¯·æœŸå¾…æ›´å¤šå†…å®¹'}}</text>
    </view>
  </view>

  <!-- æ¨èé˜…è¯» -->
  <view class="recommend-section" wx:if="{{!searchKeyword && recommendTips.length > 0}}">
    <view class="section-header">
      <text class="section-title">æ¨èé˜…è¯»</text>
    </view>
    
    <scroll-view class="recommend-scroll" scroll-x>
      <view class="recommend-list">
        <view class="recommend-item" 
              wx:for="{{recommendTips}}" 
              wx:key="id" 
              bindtap="onTipTap" 
              data-tip="{{item}}">
          <view class="recommend-header">
            <text class="recommend-icon">{{item.icon}}</text>
            <text class="recommend-category">{{item.categoryName}}</text>
          </view>
          <text class="recommend-title">{{item.title}}</text>
          <text class="recommend-summary">{{item.summary}}</text>
          <view class="recommend-footer">
            <text class="recommend-read-time">{{item.readTime}}åˆ†é’Ÿ</text>
            <text class="recommend-likes">{{item.likeCount}}èµ</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- æ¯æ—¥ä¸€è´´ -->
  <view class="daily-section" wx:if="{{!searchKeyword && dailyTip}}">
    <view class="section-header">
      <text class="section-title">æ¯æ—¥ä¸€è´´</text>
      <text class="section-date">{{todayDate}}</text>
    </view>
    
    <view class="daily-card" bindtap="onTipTap" data-tip="{{dailyTip}}">
      <view class="daily-header">
        <text class="daily-icon">{{dailyTip.icon}}</text>
        <view class="daily-meta">
          <text class="daily-title">{{dailyTip.title}}</text>
          <text class="daily-category">{{dailyTip.categoryName}}</text>
        </view>
      </view>
      
      <text class="daily-content">{{dailyTip.summary}}</text>
      
      <view class="daily-footer">
        <text class="daily-tip">ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</text>
        <text class="daily-arrow">></text>
      </view>
    </view>
  </view>
</view>

<!-- è´´å£«è¯¦æƒ…å¼¹çª— -->
<view class="tip-modal" wx:if="{{showTipDetail}}" bindtap="onCloseTipDetail">
  <view class="tip-detail" catchtap="stopPropagation">
    <view class="detail-header">
      <view class="detail-meta">
        <text class="detail-icon">{{currentTip.icon}}</text>
        <view class="detail-info">
          <text class="detail-title">{{currentTip.title}}</text>
          <text class="detail-category">{{currentTip.categoryName}}</text>
        </view>
      </view>
      <text class="detail-close" bindtap="onCloseTipDetail">âœ•</text>
    </view>
    
    <scroll-view class="detail-content" scroll-y>
      <view class="detail-summary">
        <text class="summary-text">{{currentTip.summary}}</text>
      </view>
      
      <view class="detail-body">
        <rich-text nodes="{{currentTip.content}}"></rich-text>
      </view>
      
      <view class="detail-tags">
        <text class="detail-tag" wx:for="{{currentTip.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</text>
      </view>
      
      <view class="detail-references" wx:if="{{currentTip.references && currentTip.references.length > 0}}">
        <text class="references-title">å‚è€ƒèµ„æ–™</text>
        <view class="references-list">
          <text class="reference-item" wx:for="{{currentTip.references}}" wx:key="*this" wx:for-item="ref">{{ref}}</text>
        </view>
      </view>
    </scroll-view>
    
    <view class="detail-actions">
      <button class="action-btn secondary" bindtap="onLikeTipDetail">
        <text class="btn-icon">{{currentTip.liked ? 'â¤ï¸' : 'ğŸ¤'}}</text>
        <text class="btn-text">{{currentTip.liked ? 'å·²ç‚¹èµ' : 'ç‚¹èµ'}}</text>
        <text class="btn-count">({{currentTip.likeCount}})</text>
      </button>
      
      <button class="action-btn secondary" bindtap="onCollectTip">
        <text class="btn-icon">{{currentTip.collected ? 'â­' : 'â˜†'}}</text>
        <text class="btn-text">{{currentTip.collected ? 'å·²æ”¶è—' : 'æ”¶è—'}}</text>
      </button>
      
      <button class="action-btn primary" bindtap="onShareTip">
        <text class="btn-icon">ğŸ“¤</text>
        <text class="btn-text">åˆ†äº«</text>
      </button>
    </view>
  </view>
</view>