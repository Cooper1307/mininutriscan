# 开发环境配置说明

## 问题解决

本次修改解决了以下开发环境中的问题：

### 1. 域名校验错误
**问题**: `http://127.0.0.1:8000 不在以下 request 合法域名列表中`

**解决方案**: 
- 在 `project.config.json` 和 `project.private.config.json` 中设置 `"urlCheck": false`
- 这样在开发环境中可以访问本地服务器，无需配置正式的域名

### 2. 权限配置错误
**问题**: `invalid app.json permission["scope.camera"]、app.json permission["scope.album"]`

**解决方案**: 
- 移除了 `app.json` 中不正确的 `scope.camera` 和 `scope.album` 权限配置
- 这些权限在小程序中是自动处理的，不需要在 app.json 中声明

### 3. 位置权限配置
**问题**: `getLocation:fail the api need to be declared in the requiredPrivateInfos field`

**解决方案**: 
- 在 `app.json` 中添加了 `"requiredPrivateInfos": ["getLocation"]`
- 保留了 `permission.scope.userLocation` 的描述信息

## 配置文件说明

### app.json
- 移除了错误的相机和相册权限配置
- 添加了 `requiredPrivateInfos` 字段声明位置权限
- 保留了用户位置权限的描述信息

### project.config.json
- 添加了 `"urlCheck": false` 和 `"checkSiteMap": false`
- 允许在开发环境中访问本地服务器

### project.private.config.json
- 设置 `"urlCheck": false`
- 添加 `"checkSiteMap": false`
- 这些设置只在开发环境中生效

## 使用说明

1. **开发环境**: 当前配置适用于本地开发，可以访问 `http://127.0.0.1:8000` 等本地服务器

2. **生产环境**: 发布到正式环境时，需要：
   - 在微信小程序后台配置正式的服务器域名
   - 确保服务器使用 HTTPS 协议
   - 域名必须经过 ICP 备案

3. **重新编译**: 修改配置后，请：
   - 重新编译小程序项目
   - 如果仍有问题，可以尝试清除缓存后重新编译

## 注意事项

- `urlCheck: false` 只应在开发环境中使用
- 正式发布前必须配置合法的服务器域名
- 位置权限需要用户主动授权才能使用
- 相机和相册权限会在使用相关 API 时自动请求

## 相关文档

- [微信小程序网络配置文档](https://developers.weixin.qq.com/miniprogram/dev/framework/ability/network.html)
- [小程序权限配置说明](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html)